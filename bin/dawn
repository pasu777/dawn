#!/usr/bin/env node
var path = require('path');
var project = require('commander').version('0.0.1');
var workSpace = process.cwd();
project.option(
    '-d, --dir [dir]',
    'Initial project at [dir]',
    function resolveDir (dir) {
      'use strict';
      if (dir.indexOf('.') === 0) {
        return path.resolve(process.cwd() + '/' + dir);
      }
    },
    workSpace
  ).option(
    '-m, --mode [mode]',
    function resolveInitMode (mode) {
      'use strict';
      var modeMap = {
        deploy: 1,
        dev: 1
      };
      if (modeMap[mode] !== 1) {
        return 'dev';
      }
    }, 'dev'
  ).option(
    '-S, --no-static',
    'Without static files'
  ).option(
    '-t, --tmpl',
    'With template file'
  );

project.command('init <switch> <name>').
  description('Initial the project').
  action(function onInitProject (which, name, env) {
    'use strict';
    var filePath = path.resolve(__dirname + '/../libs/dawn_init_' + which + '.js');
    require(filePath).init(env, name);
  });

project.command('ui').
  description('Run UI server').
  action(function onUI (env) {
    'use strict';
    var filePath = __dirname + '/../libs/dawn_ui.js';
    require(filePath).init(env);
  });
project.command('test').
  description('Run test script').
  action(function onTest (env) {
    'use strict';
    var filePath = __dirname + '/../libs/dawn_test.js';
    require(filePath).init(env);
  });

project.parse(process.argv);