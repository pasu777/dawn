#!/usr/bin/env node
var path = require('path'),
project = require('commander').
  version('0.0.0');

project.command('init').
  description('Initial the project').
  option(
    '-d, --dir [dir]',
    'Initial project at [dir]',
    function resolveDir(dir) {
      if (dir.indexOf('.') === 0) {
        return path.resolve(process.cwd() + '/' + dir);
      }
    },
    process.cwd()
  ).action(function onInit(env) {
    require(__dirname + '/../libs/dawn-init.js').init(env);
  });
project.command('ui').
  description('Run UI server').
  option(
    '-p, --port [port]',
    'Run dawn at http(s)://location:[port]',
    function resolvePort(port) {
      port = +port | 0;
      if (port > 0 ) {
        return port;
      }
    },
    8000
  ).action(function onUI(env) {
    require(__dirname + '/../libs/dawn-ui.js').init(env);
  });
project.command('test [env]').
  description('Run test script').
  option(
    '-t, --type [type]',
    'Test project with [type]',
    'all'
  ).action(function onTest(env) {
    require(__dirname + '/../libs/dawn-test.js').init(env);
  });
project.parse(process.argv);
